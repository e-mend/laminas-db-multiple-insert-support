<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Database abstraction layer, SQL abstraction, result set abstraction, and RowDataGateway and TableDataGateway implementations"> 

    
    
    <meta name="docsearch:version" content="latest">
    <meta name="docsearch:language" content="en">
    <meta name="docsearch:component" content="laminas-db">

    <link rel="canonical" href="https://docs.laminas.dev/laminas-db/sql/">
    <link rel="shortcut icon" href="https://docs.laminas.dev/img/trademark-laminas-foundation-rgb.svg">

    <title>SQL Abstraction - laminas-db - Laminas Docs</title>

    <link rel="stylesheet" href="https://docs.laminas.dev/css/styles.css">
    
</head>
<body id="page-top" class="components" data-spy="scroll" data-target=".toc" data-offset="20">

    
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        
        <a class="logo-link navbar-brand" href="https://getlaminas.org/" data-tooltip data-placement="bottom" title="Go to the Laminas homepage">
            <img src="https://docs.laminas.dev/img/laminas-foundation-white.svg" height="28" alt="Laminas">
        </a>
        <a class="navbar-title" href="https://docs.laminas.dev/" data-tooltip data-placement="bottom" title="Go to the Laminas Documentation">
            Documentation
        </a>

        
        <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">

            
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <div class="dropdown sub-project-selector">
                        <a class="dropdown-toggle nav-link" data-toggle="dropdown" aria-expanded="false">
                            All Docs
                        </a>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a href="https://docs.mezzio.dev/" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-mezzio-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>Mezzio</strong><br>
                                        PSR-15 Middleware in Minutes
                                    </div>
                                </div>
                            </a>
                            <a href="https://docs.laminas.dev/components/" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-components-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>Components</strong><br>
                                        Components for Enterprise Applications
                                    </div>
                                </div>
                            </a>
                            <a href="https://docs.laminas.dev/mvc" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-mvc-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>MVC</strong><br>
                                        MVC for Enterprise Applications
                                    </div>
                                </div>
                            </a>
                            <a href="https://api-tools.getlaminas.org/documentation" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-api-tools-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>API Tools</strong><br>
                                        Build RESTful APIs in Minutes
                                    </div>
                                </div>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item dropdown-item--secondardy" href="https://docs.laminas.dev/migration/">
                                <div class="row align-items-center">
                                    <div class="col-md-8 offset-md-4 col-sm-12">
                                        Migration to Laminas
                                    </div>
                                </div>
                            </a>
                            <a class="dropdown-item dropdown-item--secondardy" href="https://docs.laminas.dev/tutorials/">
                                <div class="row align-items-center">
                                    <div class="col-md-8 offset-md-4 col-sm-12">
                                        Tutorials
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="https://getlaminas.org/participate" class="nav-link">Community</a>
                </li>
            </ul>

            
            
                <div class="d-block d-sm-none">
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="..">laminas-db</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Adapters</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../adapter/" class="subnavigation__link">Introduction</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../adapters/adapter-aware-trait/" class="subnavigation__link">AdapterAwareTrait</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../result-set/" class="subnavigation__link">Result Sets</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item subnavigation__list-item--active">
                                <a href="./" class="subnavigation__link">SQL Abstraction</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../sql-ddl/" class="subnavigation__link">DDL Abstraction</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../table-gateway/" class="subnavigation__link">Table Gateways</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../row-gateway/" class="subnavigation__link">Row Gateways</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../metadata/" class="subnavigation__link">RDBMS Metadata</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Application Integration</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../application-integration/usage-in-a-laminas-mvc-application/" class="subnavigation__link">Integrating in a Laminas MVC application</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            
        </ul>
    </div>

                </div>
            

            
            <div class="d-block d-sm-none">
                <div class="component-selector">
    
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</nav>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-8">
                <h1 class="header__title">
                    Components

                    
                        <small class="header__subtitle">laminas-db</small>
                    
                </h1>
            </div>

            
            <div class="col-4 text-right">
                
                    

                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/laminas/laminas-db" class="header__link header__link--github" title="Go to repository of laminas-db">
                        <i class="fab fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-sm-12 content" role="main">
                
                
                    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">On this page</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#quick-start" class="toc__link nav-link">Quick start</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#common-interfaces-for-sql-implementations" class="toc__link nav-link">Common interfaces for SQL implementations</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#select" class="toc__link nav-link">Select</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#insert" class="toc__link nav-link">Insert</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#update" class="toc__link nav-link">Update</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#delete" class="toc__link nav-link">Delete</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#where-and-having" class="toc__link nav-link">Where and Having</a>
                    </li>
                
            </ul>
        </div>
    

                

                
                    <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        
            <li class="breadcrumb-item"><a href="https://docs.laminas.dev/">Overview</a></li>
            <li class="breadcrumb-item"><a href="https://docs.laminas.dev/components/">Components</a></li>

            
                <li class="breadcrumb-item"><a href="..">laminas-db</a></li>

                

                <li class="breadcrumb-item active" aria-current="page">SQL Abstraction</li>
            
        
    </ol>
</nav>






    
    

    <h1 id="sql-abstraction">SQL Abstraction</h1>
<p><code>Laminas\Db\Sql</code> is a SQL abstraction layer for building platform-specific SQL
queries via an object-oriented API. The end result of a <code>Laminas\Db\Sql</code> object
will be to either produce a <code>Statement</code> and <code>ParameterContainer</code> that
represents the target query, or a full string that can be directly executed
against the database platform. To achieve this, <code>Laminas\Db\Sql</code> objects require a
<code>Laminas\Db\Adapter\Adapter</code> object in order to produce the desired results.</p>
<h2 id="quick-start">Quick start</h2>
<p>There are four primary tasks associated with interacting with a database
defined by Data Manipulation Language (DML): selecting, inserting, updating,
and deleting. As such, there are four primary classes that developers can
interact with in order to build queries in the <code>Laminas\Db\Sql</code> namespace:
<code>Select</code>, <code>Insert</code>, <code>Update</code>, and <code>Delete</code>.</p>
<p>Since these four tasks are so closely related and generally used together
within the same application, the <code>Laminas\Db\Sql\Sql</code> class helps you create them
and produce the result you are attempting to achieve.</p>
<pre class="highlight"><code class="language-php">use Laminas\Db\Sql\Sql;

$sql    = new Sql($adapter);
$select = $sql-&gt;select(); // returns a Laminas\Db\Sql\Select instance
$insert = $sql-&gt;insert(); // returns a Laminas\Db\Sql\Insert instance
$update = $sql-&gt;update(); // returns a Laminas\Db\Sql\Update instance
$delete = $sql-&gt;delete(); // returns a Laminas\Db\Sql\Delete instance</code></pre>
<p>As a developer, you can now interact with these objects, as described in the
sections below, to customize each query. Once they have been populated with
values, they are ready to either be prepared or executed.</p>
<p>To prepare (using a Select object):</p>
<pre class="highlight"><code class="language-php">use Laminas\Db\Sql\Sql;

$sql    = new Sql($adapter);
$select = $sql-&gt;select();
$select-&gt;from('foo');
$select-&gt;where(['id' =&gt; 2]);

$statement = $sql-&gt;prepareStatementForSqlObject($select);
$results = $statement-&gt;execute();</code></pre>
<p>To execute (using a Select object)</p>
<pre class="highlight"><code class="language-php">use Laminas\Db\Sql\Sql;

$sql    = new Sql($adapter);
$select = $sql-&gt;select();
$select-&gt;from('foo');
$select-&gt;where(['id' =&gt; 2]);

$selectString = $sql-&gt;buildSqlString($select);
$results = $adapter-&gt;query($selectString, $adapter::QUERY_MODE_EXECUTE);</code></pre>
<p><code>Laminas\\Db\\Sql\\Sql</code> objects can also be bound to a particular table so that in
obtaining a <code>Select</code>, <code>Insert</code>, <code>Update</code>, or <code>Delete</code> instance, the object will be
seeded with the table:</p>
<pre class="highlight"><code class="language-php">use Laminas\Db\Sql\Sql;

$sql    = new Sql($adapter, 'foo');
$select = $sql-&gt;select();
$select-&gt;where(['id' =&gt; 2]); // $select already has from('foo') applied</code></pre>
<h2 id="common-interfaces-for-sql-implementations">Common interfaces for SQL implementations</h2>
<p>Each of these objects implements the following two interfaces:</p>
<pre class="highlight"><code class="language-php">interface PreparableSqlInterface
{
     public function prepareStatement(Adapter $adapter, StatementInterface $statement) : void;
}

interface SqlInterface
{
     public function getSqlString(PlatformInterface $adapterPlatform = null) : string;
}</code></pre>
<p>Use these functions to produce either (a) a prepared statement, or (b) a string
to execute.</p>
<h2 id="select">Select</h2>
<p><code>Laminas\Db\Sql\Select</code> presents a unified API for building platform-specific SQL
SELECT queries. Instances may be created and consumed without
<code>Laminas\Db\Sql\Sql</code>:</p>
<pre class="highlight"><code class="language-php">use Laminas\Db\Sql\Select;

$select = new Select();
// or, to produce a $select bound to a specific table
$select = new Select('foo');</code></pre>
<p>If a table is provided to the <code>Select</code> object, then <code>from()</code> cannot be called
later to change the name of the table.</p>
<p>Once you have a valid <code>Select</code> object, the following API can be used to further
specify various select statement parts:</p>
<pre class="highlight"><code class="language-php">class Select extends AbstractSql implements SqlInterface, PreparableSqlInterface
{
    const JOIN_INNER = 'inner';
    const JOIN_OUTER = 'outer';
    const JOIN_FULL_OUTER  = 'full outer';
    const JOIN_LEFT = 'left';
    const JOIN_RIGHT = 'right';
    const SQL_STAR = '*';
    const ORDER_ASCENDING = 'ASC';
    const ORDER_DESCENDING = 'DESC';

    public $where; // @param Where $where

    public function __construct(string|array|TableIdentifier $table = null);
    public function from(string|array|TableIdentifier $table) : self;
    public function columns(array $columns, bool $prefixColumnsWithTable = true) : self;
    public function join(string|array|TableIdentifier $name, string $on, string|array $columns = self::SQL_STAR, string $type = self::JOIN_INNER) : self;
    public function where(Where|callable|string|array|PredicateInterface $predicate, string $combination = Predicate\PredicateSet::OP_AND) : self;
    public function group(string|array $group);
    public function having(Having|callable|string|array $predicate, string $combination = Predicate\PredicateSet::OP_AND) : self;
    public function order(string|array $order) : self;
    public function limit(int $limit) : self;
    public function offset(int $offset) : self;
}</code></pre>
<h3 id="from">from()</h3>
<pre class="highlight"><code class="language-php">// As a string:
$select-&gt;from('foo');

// As an array to specify an alias
// (produces SELECT "t".* FROM "table" AS "t")
$select-&gt;from(['t' =&gt; 'table']);

// Using a Sql\TableIdentifier:
// (same output as above)
$select-&gt;from(['t' =&gt; new TableIdentifier('table')]);</code></pre>
<h3 id="columns">columns()</h3>
<pre class="highlight"><code class="language-php">// As an array of names
$select-&gt;columns(['foo', 'bar']);

// As an associative array with aliases as the keys
// (produces 'bar' AS 'foo', 'bax' AS 'baz')
$select-&gt;columns([
    'foo' =&gt; 'bar',
    'baz' =&gt; 'bax'
]);

// Sql function call on the column
// (produces CONCAT_WS('/', 'bar', 'bax') AS 'foo')
$select-&gt;columns([
    'foo' =&gt; new \Laminas\Db\Sql\Expression("CONCAT_WS('/', 'bar', 'bax')")
]);</code></pre>
<h3 id="join">join()</h3>
<pre class="highlight"><code class="language-php">$select-&gt;join(
    'foo',              // table name
    'id = bar.id',      // expression to join on (will be quoted by platform object before insertion),
    ['bar', 'baz'],     // (optional) list of columns, same requirements as columns() above
    $select::JOIN_OUTER // (optional), one of inner, outer, full outer, left, right also represented by constants in the API
);

$select
    -&gt;from(['f' =&gt; 'foo'])     // base table
    -&gt;join(
        ['b' =&gt; 'bar'],        // join table with alias
        'f.foo_id = b.foo_id'  // join expression
    );</code></pre>
<h3 id="where-having">where(), having()</h3>
<p><code>Laminas\Db\Sql\Select</code> provides bit of flexibility as it regards to what kind of
parameters are acceptable when calling <code>where()</code> or <code>having()</code>. The method
signature is listed as:</p>
<pre class="highlight"><code class="language-php">/**
 * Create where clause
 *
 * @param  Where|callable|string|array $predicate
 * @param  string $combination One of the OP_* constants from Predicate\PredicateSet
 * @return Select
 */
public function where($predicate, $combination = Predicate\PredicateSet::OP_AND);</code></pre>
<p>If you provide a <code>Laminas\Db\Sql\Where</code> instance to <code>where()</code> or a
<code>Laminas\Db\Sql\Having</code> instance to <code>having()</code>, any previous internal instances
will be replaced completely. When either instance is processed, this object will
be iterated to produce the WHERE or HAVING section of the SELECT statement.</p>
<p>If you provide a PHP callable to <code>where()</code> or <code>having()</code>, this function will be
called with the <code>Select</code>'s <code>Where</code>/<code>Having</code> instance as the only parameter.
This enables code like the following:</p>
<pre class="highlight"><code class="language-php">$select-&gt;where(function (Where $where) {
    $where-&gt;like('username', 'ralph%');
});</code></pre>
<p>If you provide a <em>string</em>, this string will be used to create a
<code>Laminas\Db\Sql\Predicate\Expression</code> instance, and its contents will be applied
as-is, with no quoting:</p>
<pre class="highlight"><code class="language-php">// SELECT "foo".* FROM "foo" WHERE x = 5
$select-&gt;from('foo')-&gt;where('x = 5');</code></pre>
<p>If you provide an array with integer indices, the value can be one of:</p>
<ul>
<li>a string; this will be used to build a <code>Predicate\Expression</code>.</li>
<li>any object implementing <code>Predicate\PredicateInterface</code>.</li>
</ul>
<p>In either case, the instances are pushed onto the <code>Where</code> stack with the
<code>$combination</code> provided (defaulting to <code>AND</code>).</p>
<p>As an example:</p>
<pre class="highlight"><code class="language-php">// SELECT "foo".* FROM "foo" WHERE x = 5 AND y = z
$select-&gt;from('foo')-&gt;where(['x = 5', 'y = z']);</code></pre>
<p>If you provide an associative array with string keys, any value with a string
key will be cast as follows:</p>
<div class="table-responsive"><table>
<thead>
<tr>
<th>PHP value</th>
<th>Predicate type</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>null</code></td>
<td><code>Predicate\IsNull</code></td>
</tr>
<tr>
<td><code>array</code></td>
<td><code>Predicate\In</code></td>
</tr>
<tr>
<td><code>string</code></td>
<td><code>Predicate\Operator</code>, where the key is the identifier.</td>
</tr>
</tbody>
</table></div>
<p>As an example:</p>
<pre class="highlight"><code class="language-php">// SELECT "foo".* FROM "foo" WHERE "c1" IS NULL AND "c2" IN (?, ?, ?) AND "c3" IS NOT NULL
$select-&gt;from('foo')-&gt;where([
    'c1' =&gt; null,
    'c2' =&gt; [1, 2, 3],
    new \Laminas\Db\Sql\Predicate\IsNotNull('c3'),
]);</code></pre>
<p>As another example of complex queries with nested conditions e.g.</p>
<pre class="highlight"><code class="language-sql">SELECT * WHERE (column1 is null or column1 = 2) AND (column2 = 3)</code></pre>
<p>you need to use the <code>nest()</code> and <code>unnest()</code> methods, as follows:</p>
<pre class="highlight"><code class="language-php">$select-&gt;where-&gt;nest() // bracket opened
    -&gt;isNull('column1')
    -&gt;or
    -&gt;equalTo('column1', '2')
    -&gt;unnest();  // bracket closed
    -&gt;equalTo('column2', '3');</code></pre>
<h3 id="order">order()</h3>
<pre class="highlight"><code class="language-php">$select = new Select;
$select-&gt;order('id DESC'); // produces 'id' DESC

$select = new Select;
$select
    -&gt;order('id DESC')
    -&gt;order('name ASC, age DESC'); // produces 'id' DESC, 'name' ASC, 'age' DESC

$select = new Select;
$select-&gt;order(['name ASC', 'age DESC']); // produces 'name' ASC, 'age' DESC</code></pre>
<h3 id="limit-and-offset">limit() and offset()</h3>
<pre class="highlight"><code class="language-php">$select = new Select;
$select-&gt;limit(5);   // always takes an integer/numeric
$select-&gt;offset(10); // similarly takes an integer/numeric</code></pre>
<h2 id="insert">Insert</h2>
<p>The Insert API:</p>
<pre class="highlight"><code class="language-php">class Insert implements SqlInterface, PreparableSqlInterface
{
    const VALUES_MERGE = 'merge';
    const VALUES_SET   = 'set';

    public function __construct(string|TableIdentifier $table = null);
    public function into(string|TableIdentifier $table) : self;
    public function columns(array $columns) : self;
    public function values(array $values, string $flag = self::VALUES_SET) : self;
}</code></pre>
<p>As with <code>Select</code>, the table may be provided during instantiation or via the
<code>into()</code> method.</p>
<h3 id="columns_1">columns()</h3>
<pre class="highlight"><code class="language-php">$insert-&gt;columns(['foo', 'bar']); // set the valid columns</code></pre>
<h3 id="values">values()</h3>
<p>The default behavior of values is to set the values. Successive calls will not
preserve values from previous calls.</p>
<pre class="highlight"><code class="language-php">$insert-&gt;values([
    'col_1' =&gt; 'value1',
    'col_2' =&gt; 'value2',
]);</code></pre>
<p>To merge values with previous calls, provide the appropriate flag:
<code>Laminas\Db\Sql\Insert::VALUES_MERGE</code></p>
<pre class="highlight"><code class="language-php">$insert-&gt;values(['col_2' =&gt; 'value2'], $insert::VALUES_MERGE);</code></pre>
<h2 id="update">Update</h2>
<pre class="highlight"><code class="language-php">class Update
{
    const VALUES_MERGE = 'merge';
    const VALUES_SET   = 'set';

    public $where; // @param Where $where
    public function __construct(string|TableIdentifier $table = null);
    public function table(string|TableIdentifier $table) : self;
    public function set(array $values, string $flag = self::VALUES_SET) : self;
    public function where(Where|callable|string|array|PredicateInterface $predicate, string $combination = Predicate\PredicateSet::OP_AND) : self;
}</code></pre>
<h3 id="set">set()</h3>
<pre class="highlight"><code class="language-php">$update-&gt;set(['foo' =&gt; 'bar', 'baz' =&gt; 'bax']);</code></pre>
<h3 id="where">where()</h3>
<p>See the <a href="#where-and-having">section on Where and Having</a>.</p>
<h2 id="delete">Delete</h2>
<pre class="highlight"><code class="language-php">class Delete
{
    public $where; // @param Where $where

    public function __construct(string|TableIdentifier $table = null);
    public function from(string|TableIdentifier $table);
    public function where(Where|callable|string|array|PredicateInterface $predicate, string $combination = Predicate\PredicateSet::OP_AND) : self;
}</code></pre>
<h3 id="where_1">where()</h3>
<p>See the <a href="#where-and-having">section on Where and Having</a>.</p>
<h2 id="where-and-having">Where and Having</h2>
<p>In the following, we will talk about <code>Where</code>; note, however, that <code>Having</code>
utilizes the same API.</p>
<p>Effectively, <code>Where</code> and <code>Having</code> extend from the same base object, a
<code>Predicate</code> (and <code>PredicateSet</code>). All of the parts that make up a WHERE or
HAVING clause that are AND'ed or OR'd together are called <em>predicates</em>.  The
full set of predicates is called a <code>PredicateSet</code>. A <code>Predicate</code> generally
contains the values (and identifiers) separate from the fragment they belong to
until the last possible moment when the statement is either prepared
(parameteritized) or executed. In parameterization, the parameters will be
replaced with their proper placeholder (a named or positional parameter), and
the values stored inside an <code>Adapter\ParameterContainer</code>. When executed, the
values will be interpolated into the fragments they belong to and properly
quoted.</p>
<p>In the <code>Where</code>/<code>Having</code> API, a distinction is made between what elements are
considered identifiers (<code>TYPE_IDENTIFIER</code>) and which are values (<code>TYPE_VALUE</code>).
There is also a special use case type for literal values (<code>TYPE_LITERAL</code>). All
element types are expressed via the <code>Laminas\Db\Sql\ExpressionInterface</code>
interface.</p>
<blockquote>
<h3 id="literals">Literals</h3>
<p>In Laminas 2.1, an actual <code>Literal</code> type was added. <code>Laminas\Db\Sql</code> now makes the
distinction that literals will not have any parameters that need
interpolating, while <code>Expression</code> objects <em>might</em> have parameters that need
interpolating. In cases where there are parameters in an <code>Expression</code>,
<code>Laminas\Db\Sql\AbstractSql</code> will do its best to identify placeholders when the
<code>Expression</code> is processed during statement creation. In short, if you don't
have parameters, use <code>Literal</code> objects.</p>
</blockquote>
<p>The <code>Where</code> and <code>Having</code> API is that of <code>Predicate</code> and <code>PredicateSet</code>:</p>
<pre class="highlight"><code class="language-php">// Where &amp; Having extend Predicate:
class Predicate extends PredicateSet
{
    public $and;
    public $or;
    public $AND;
    public $OR;
    public $NEST;
    public $UNNEST;

    public function nest() : Predicate;
    public function setUnnest(Predicate $predicate) : void;
    public function unnest() : Predicate;
    public function equalTo(
        int|float|bool|string $left,
        int|float|bool|string $right,
        string $leftType = self::TYPE_IDENTIFIER,
        string $rightType = self::TYPE_VALUE
    ) : self;
    public function notEqualTo(
        int|float|bool|string $left,
        int|float|bool|string $right,
        string $leftType = self::TYPE_IDENTIFIER,
        string $rightType = self::TYPE_VALUE
    ) : self;
    public function lessThan(
        int|float|bool|string $left,
        int|float|bool|string $right,
        string $leftType = self::TYPE_IDENTIFIER,
        string $rightType = self::TYPE_VALUE
    ) : self;
    public function greaterThan(
        int|float|bool|string $left,
        int|float|bool|string $right,
        string $leftType = self::TYPE_IDENTIFIER,
        string $rightType = self::TYPE_VALUE
    ) : self;
    public function lessThanOrEqualTo(
        int|float|bool|string $left,
        int|float|bool|string $right,
        string $leftType = self::TYPE_IDENTIFIER,
        string $rightType = self::TYPE_VALUE
    ) : self;
    public function greaterThanOrEqualTo(
        int|float|bool|string $left,
        int|float|bool|string $right,
        string $leftType = self::TYPE_IDENTIFIER,
        string $rightType = self::TYPE_VALUE
    ) : self;
    public function like(string $identifier, string $like) : self;
    public function notLike(string $identifier, string $notLike) : self;
    public function literal(string $literal) : self;
    public function expression(string $expression, array $parameters = null) : self;
    public function isNull(string $identifier) : self;
    public function isNotNull(string $identifier) : self;
    public function in(string $identifier, array $valueSet = []) : self;
    public function notIn(string $identifier, array $valueSet = []) : self;
    public function between(
        string $identifier,
        int|float|string $minValue,
        int|float|string $maxValue
    ) : self;
    public function notBetween(
        string $identifier,
        int|float|string $minValue,
        int|float|string $maxValue
    ) : self;
    public function predicate(PredicateInterface $predicate) : self;

    // Inherited From PredicateSet

    public function addPredicate(PredicateInterface $predicate, $combination = null) : self;
    public function getPredicates() PredicateInterface[];
    public function orPredicate(PredicateInterface $predicate) : self;
    public function andPredicate(PredicateInterface $predicate) : self;
    public function getExpressionData() : array;
    public function count() : int;
}</code></pre>
<p>Each method in the API will produce a corresponding <code>Predicate</code> object of a similarly named
type, as described below.</p>
<h3 id="equalto-lessthan-greaterthan-lessthanorequalto-greaterthanorequalto">equalTo(), lessThan(), greaterThan(), lessThanOrEqualTo(), greaterThanOrEqualTo()</h3>
<pre class="highlight"><code class="language-php">$where-&gt;equalTo('id', 5);

// The above is equivalent to:
$where-&gt;addPredicate(
    new Predicate\Operator($left, Operator::OPERATOR_EQUAL_TO, $right, $leftType, $rightType)
);</code></pre>
<p>Operators use the following API:</p>
<pre class="highlight"><code class="language-php">class Operator implements PredicateInterface
{
    const OPERATOR_EQUAL_TO                  = '=';
    const OP_EQ                              = '=';
    const OPERATOR_NOT_EQUAL_TO              = '!=';
    const OP_NE                              = '!=';
    const OPERATOR_LESS_THAN                 = '&lt;';
    const OP_LT                              = '&lt;';
    const OPERATOR_LESS_THAN_OR_EQUAL_TO     = '&lt;=';
    const OP_LTE                             = '&lt;=';
    const OPERATOR_GREATER_THAN              = '&gt;';
    const OP_GT                              = '&gt;';
    const OPERATOR_GREATER_THAN_OR_EQUAL_TO  = '&gt;=';
    const OP_GTE                             = '&gt;=';

    public function __construct(
        int|float|bool|string $left = null,
        string $operator = self::OPERATOR_EQUAL_TO,
        int|float|bool|string $right = null,
        string $leftType = self::TYPE_IDENTIFIER,
        string $rightType = self::TYPE_VALUE
    );
    public function setLeft(int|float|bool|string $left);
    public function getLeft() : int|float|bool|string;
    public function setLeftType(string $type) : self;
    public function getLeftType() : string;
    public function setOperator(string $operator);
    public function getOperator() : string;
    public function setRight(int|float|bool|string $value) : self;
    public function getRight() : int|float|bool|string;
    public function setRightType(string $type) : self;
    public function getRightType() : string;
    public function getExpressionData() : array;
}</code></pre>
<h3 id="likeidentifier-like-notlikeidentifier-notlike">like($identifier, $like), notLike($identifier, $notLike)</h3>
<pre class="highlight"><code class="language-php">$where-&gt;like($identifier, $like):

// The above is equivalent to:
$where-&gt;addPredicate(
    new Predicate\Like($identifier, $like)
);</code></pre>
<p>The following is the <code>Like</code> API:</p>
<pre class="highlight"><code class="language-php">class Like implements PredicateInterface
{
    public function __construct(string $identifier = null, string $like = null);
    public function setIdentifier(string $identifier) : self;
    public function getIdentifier() : string;
    public function setLike(string $like) : self;
    public function getLike() : string;
}</code></pre>
<h3 id="literalliteral">literal($literal)</h3>
<pre class="highlight"><code class="language-php">$where-&gt;literal($literal);

// The above is equivalent to:
$where-&gt;addPredicate(
    new Predicate\Literal($literal)
);</code></pre>
<p>The following is the <code>Literal</code> API:</p>
<pre class="highlight"><code class="language-php">class Literal implements ExpressionInterface, PredicateInterface
{
    const PLACEHOLDER = '?';
    public function __construct(string $literal = '');
    public function setLiteral(string $literal) : self;
    public function getLiteral() : string;
}</code></pre>
<h3 id="expressionexpression-parameter">expression($expression, $parameter)</h3>
<pre class="highlight"><code class="language-php">$where-&gt;expression($expression, $parameter);

// The above is equivalent to:
$where-&gt;addPredicate(
    new Predicate\Expression($expression, $parameter)
);</code></pre>
<p>The following is the <code>Expression</code> API:</p>
<pre class="highlight"><code class="language-php">class Expression implements ExpressionInterface, PredicateInterface
{
    const PLACEHOLDER = '?';

    public function __construct(
        string $expression = null,
        int|float|bool|string|array $valueParameter = null
        /* [, $valueParameter, ...  ] */
    );
    public function setExpression(string $expression) : self;
    public function getExpression() : string;
    public function setParameters(int|float|bool|string|array $parameters) : self;
    public function getParameters() : array;
}</code></pre>
<h3 id="isnullidentifier">isNull($identifier)</h3>
<pre class="highlight"><code class="language-php">$where-&gt;isNull($identifier);

// The above is equivalent to:
$where-&gt;addPredicate(
    new Predicate\IsNull($identifier)
);</code></pre>
<p>The following is the <code>IsNull</code> API:</p>
<pre class="highlight"><code class="language-php">class IsNull implements PredicateInterface
{
    public function __construct(string $identifier = null);
    public function setIdentifier(string $identifier) : self;
    public function getIdentifier() : string;
}</code></pre>
<h3 id="isnotnullidentifier">isNotNull($identifier)</h3>
<pre class="highlight"><code class="language-php">$where-&gt;isNotNull($identifier);

// The above is equivalent to:
$where-&gt;addPredicate(
    new Predicate\IsNotNull($identifier)
);</code></pre>
<p>The following is the <code>IsNotNull</code> API:</p>
<pre class="highlight"><code class="language-php">class IsNotNull implements PredicateInterface
{
    public function __construct(string $identifier = null);
    public function setIdentifier(string $identifier) : self;
    public function getIdentifier() : string;
}</code></pre>
<h3 id="inidentifier-valueset-notinidentifier-valueset">in($identifier, $valueSet), notIn($identifier, $valueSet)</h3>
<pre class="highlight"><code class="language-php">$where-&gt;in($identifier, $valueSet);

// The above is equivalent to:
$where-&gt;addPredicate(
    new Predicate\In($identifier, $valueSet)
);</code></pre>
<p>The following is the <code>In</code> API:</p>
<pre class="highlight"><code class="language-php">class In implements PredicateInterface
{
    public function __construct(
        string|array $identifier = null,
        array|Select $valueSet = null
    );
    public function setIdentifier(string|array $identifier) : self;
    public function getIdentifier() : string|array;
    public function setValueSet(array|Select $valueSet) : self;
    public function getValueSet() : array|Select;
}</code></pre>
<h3 id="betweenidentifier-minvalue-maxvalue-notbetweenidentifier-minvalue-maxvalue">between($identifier, $minValue, $maxValue), notBetween($identifier, $minValue, $maxValue)</h3>
<pre class="highlight"><code class="language-php">$where-&gt;between($identifier, $minValue, $maxValue);

// The above is equivalent to:
$where-&gt;addPredicate(
    new Predicate\Between($identifier, $minValue, $maxValue)
);</code></pre>
<p>The following is the <code>Between</code> API:</p>
<pre class="highlight"><code class="language-php">class Between implements PredicateInterface
{
    public function __construct(
        string $identifier = null,
        int|float|string $minValue = null,
        int|float|string $maxValue = null
    );
    public function setIdentifier(string $identifier) : self;
    public function getIdentifier() : string;
    public function setMinValue(int|float|string $minValue) : self;
    public function getMinValue() : int|float|string;
    public function setMaxValue(int|float|string $maxValue) : self;
    public function getMaxValue() : int|float|string;
    public function setSpecification(string $specification);
}</code></pre>




    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../result-set/">
                    <small class="page-nav__label">Previous</small>
                    <i class="fa fa-chevron-left"></i>
                    Result Sets
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../sql-ddl/">
                    <small class="page-nav__label">Next</small>
                    DDL Abstraction
                    <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>



                
            </div>
            <div class="col-md-3 col-sm-12 sidebar">
                <div class="donation-banner">
    <a href="https://getlaminas.org/support/">
        <h2>Donate</h2>
        <p>Support Laminas Developers Directly</p>
        <img src="https://funding.communitybridge.org/assets/cb-f-horizontal-white.svg">
    </a>
</div>

                
                    <div class="component-selector">
    
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="..">laminas-db</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Adapters</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../adapter/" class="subnavigation__link">Introduction</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../adapters/adapter-aware-trait/" class="subnavigation__link">AdapterAwareTrait</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../result-set/" class="subnavigation__link">Result Sets</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item subnavigation__list-item--active">
                                <a href="./" class="subnavigation__link">SQL Abstraction</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../sql-ddl/" class="subnavigation__link">DDL Abstraction</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../table-gateway/" class="subnavigation__link">Table Gateways</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../row-gateway/" class="subnavigation__link">Row Gateways</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../metadata/" class="subnavigation__link">RDBMS Metadata</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Application Integration</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../application-integration/usage-in-a-laminas-mvc-application/" class="subnavigation__link">Integrating in a Laminas MVC application</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            
        </ul>
    </div>

                    
                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <h5>Laminas</h5>
                <ul>
                    <li>Laminas Project <a href="https://getlaminas.org/">The new foundation for the community-supported, open source continuation of Zend Framework</a></li>
                    <li>Laminas Components and MVC <a href="https://docs.laminas.dev/">Components and MVC for enterprise applications</a></li>
                    <li>Mezzio <a href="https://docs.mezzio.dev/">PSR-15 middleware in minutes</a></li>
                    <li>Laminas API Tools <a href="https://api-tools.getlaminas.org/">Build RESTful APIs in minutes</a></li>
                </ul>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="row">

                    
                    <div class="col-md-4">
                        <h4 class="footer__headline">Support</h4>
                        <ul class="support__list">
                            <li class="support__list-item">
                                <a href="https://discourse.laminas.dev" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://laminas.dev/chat" class="support__link" title="Chat"><i class="fab fa-slack"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://github.com/laminas" class="support__link" title="Github"><i class="fab fa-github"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://phpc.social/@getlaminas" class="support__link" title="Mastodon"><i class="fab fa-mastodon"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://getlaminas.org/blog/rss.xml" class="support__link" title="Blog feed"><i class="fa fa-rss"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://getlaminas.org/security/feed" class="support__link" title="Security feed"><i class="fa fa-rss-square"></i></a>
                            </li>
                        </ul>
                    </div>

                    
                    <div class="col-md-4">
                        <h4 class="footer__headline">License</h4>
                        <p>
                            Code licensed under <a
                                href="https://github.com/laminas/laminas-db/blob/-/LICENSE.md">BSD 3-Clause</a>.
                        </p>
                    </div>

                    
                    <div class="col-md-4">
                        <h4 class="footer__headline">Copyright</h4>
                        <p>
                            <!--Built with love by the Laminas team with the help of our
                            <a href="https://github.com/laminas/laminas-db/graphs/contributors">contributors</a>.<br>-->
                            &copy; 2024 <a href="https://getlaminas.org/">Laminas Project</a> a Series of LF Projects, LLC.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>

    <script>
        let base_url = '..',
            project  = "components",
            siteName = 'laminas-db';
    </script>
    <script src="https://docs.laminas.dev/js/scripts.js"></script>
    
        <script src="../search/main.js"></script>
    

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Search</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
            </div>
            <div class="modal-body">
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search in laminas-db" id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
        </div>
    </div>
</div>
</body>


</html>
